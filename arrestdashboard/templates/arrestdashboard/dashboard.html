{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Immigration Enforcement Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        /* --- General Styles --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fa;
            color: #333;
            margin: 0;
            padding: 0;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        /* --- Header --- */
        header {
            position: relative;           /* for positioning title */
            background-color: #2c3e50;
            color: #fff;
            padding: 10px 20px;
            display: flex;
            align-items: center;
        }

        header img {
            height: 50px;
        }

        header h1 {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            margin: 0;
            font-size: 28px;
            font-family: Arial, sans-serif;
        }

        /* --- Navigation Bar --- */
        nav {
            background-color: #34495e;
            padding: 10px 20px;
            display: flex;
            justify-content: flex-start;
            gap: 20px;
        }

        nav a {
            color: #fff;
            font-weight: 500;
            transition: color 0.2s;
        }

        nav a:hover {
            color: #1abc9c;
        }

        /* --- Filters --- */
        .filters {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        select {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        select:hover {
            border-color: #2980b9;
        }

        /* --- Total Arrests --- */
        .total-arrests {
            text-align: center;
            font-size: 28px;
            font-weight: bold;
            margin: 20px auto;
            color: #e74c3c;
            background-color: #fdecea;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            max-width: 400px;
        }

        /* --- Charts --- */
        .chart-container {
            width: 95%;
            max-width: 1600px;
            margin: 20px auto;
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .map-container {
            width: 95%;
            max-width: 1600px;
            margin: 20px auto;
        }

        /* Center all headings */
        h2 {
            text-align: center;
            margin-top: 40px;
            margin-bottom: 15px;
            font-family: Arial, sans-serif;
        }

        /* Make all Plotly charts responsive */
        .chart-container > div,
        .map-container > div {
            width: 100% !important;
            height: 600px !important;
        }

        /* --- Footer --- */
        footer {
            background-color: #2c3e50;
            color: #fff;
            text-align: center;
            padding: 15px 20px;
            margin-top: 40px;
        }

        footer a {
            color: #1abc9c;
            text-decoration: none;
            font-weight: 500;
        }

        /* --- Responsive --- */
        @media (max-width: 768px) {
            .chart-container > div,
            .map-container > div {
                height: 400px !important;
            }

            .filters {
                flex-direction: column;
                align-items: center;
            }

            select {
                width: 80%;
            }

            header h1 {
                font-size: 22px;
            }

            nav {
                flex-direction: column;
                align-items: center;
            }

            nav a {
                margin-bottom: 5px;
            }
        }
    </style>
</head>
<body>

    <!-- Header with Logo -->
    <header>
        <img src="{% static 'images/logo.png' %}" alt="Logo">
        <h1>Immigration Enforcement Dashboard</h1>
    </header>

    <!-- Top Navigation -->
    <nav>
        <a href="{% url 'home' %}">Arrests Dashboard</a>
        <a href="#">Detainers Dashboard</a>
        <a href="#">Detentions Dashboard</a>
        <a href="#">Encounters Dashboard</a>
        <a href="#">Removals Dashboard</a>
    </nav>

    <!-- Filters -->
    <div class="filters">
        <form method="get">
            <label for="state">Select State:</label>
            <select name="state" id="state" onchange="this.form.submit()">
                {% for state in states %}
                    <option value="{{ state }}" {% if state == selected_state %}selected{% endif %}>{{ state }}</option>
                {% endfor %}
            </select>

            <label for="composition">Composition:</label>
            <select name="composition" id="composition" onchange="this.form.submit()">
                {% for comp in compositions %}
                    <option value="{{ comp }}" {% if comp == selected_composition %}selected{% endif %}>{{ comp }}</option>
                {% endfor %}
            </select>

            <noscript><input type="submit" value="Filter"></noscript>
        </form>
    </div>

    <!-- Total Arrests -->
    <div class="total-arrests">Total Arrests: {{ total_arrests }}</div>

    <!-- Bar chart: Arrests by State -->
    <h2>Arrests by State</h2>
    <div class="chart-container">
        {{ chart_bar_state|safe }}
    </div>

    <!-- Line chart: Monthly Arrests -->
    <h2>
        {% if selected_composition == "All" %}Monthly Arrests Over Time{% elif selected_composition == "Gender" %}Monthly Arrests by Gender{% elif selected_composition == "Criminality" %}Monthly Arrests by Criminality{% endif %}
    </h2>
    <div class="chart-container">
        {{ chart_line|safe }}
    </div>

    <!-- Bar chart: Monthly Arrests -->
    <h2>
        {% if selected_composition == "All" %}Monthly Arrests Bar Chart{% elif selected_composition == "Gender" %}Monthly Arrests by Gender (Stacked){% elif selected_composition == "Criminality" %}Monthly Arrests by Criminality (Stacked){% endif %}
    </h2>
    <div class="chart-container">
        {{ chart_bar_month|safe }}
    </div>

    <!-- Choropleth Map: US Arrests -->
    <h2>US Arrests by State</h2>
    <div class="map-container chart-container">
        {{ chart_map|safe }}
    </div>

    <!-- Footer -->
    <footer>
        &copy; 2025 Arrest Dashboard | Designed by 
        <a href="https://relevant-research.com/">Relevant Research</a> | 
        Email us at: <a href="mailto:contact@relevantresearch.com">contact@relevantresearch.com</a>
    </footer>
</body>
</html>
